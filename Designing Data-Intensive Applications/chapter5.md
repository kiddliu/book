# 第二部分 分布式的数据

对于一个成功的技术来说，真实必须优先于公关，因为自然无法被愚弄。

---

理查德·费曼，*罗杰斯委员会报告*（1986）

在本书的第一部分，我们讨论了当数据储存在单一设备上时适用的数据系统的各个方面。现在，在第二部分，我们拔高一个层级，问：多台设备参与数据的存储和获取时会发生什么？

想要把数据库分布到多个设备有许多理由：

*可扩展性*

如果数据量、读取负载或者写入负载增长到单台设备无法处理的水平，可以将负载分散到多台设备上。

*容错机制/高可用性*

如果即使在一台设备（或者几台设备，或者网络，或者整个数据中心）崩溃，你可以使用多台设备保证冗余度。当一台设备崩溃，另外一台可以立即接管。

*延迟*

如果用户遍布全球，你也许想要在世界不同地点架设服务器，使得每个用户可以就近被服务。这可以避免用户等待穿越了半个地球的网络数据包。

## 扩展以支持更高的负载

如果你只是需要扩展以支持更高的负载，最简单的方式是买一台更强筋的设备（这叫做*垂直扩展*或者*提升*）。许多CPU，许多内存芯片，以及许多磁盘可以用一个操作系统连接起来，而高速的互联使得CPU可以访问任意位置的内存或磁盘。在这种*共享内存架构*中，所有的组件加起来被当作是单个设备。

共享内存架构的问题是成本的增长超过了线性：一台有着两倍CPU，两倍内存，两倍磁盘空间的设备通常成本远远大于两倍。并且由于瓶颈问题，两倍体量的设备并不是一定可以处理两倍的负载的。

共享内存架构也只提供有限的容错机制——高端设备有热插拔组件（可以更换磁盘，内存模组甚至CPU而不关机）——但是这只限于单个物理位置。

另外一种方式是共享磁盘架构，它使用数台有着独立CPU和内存的设备，但是存储数据在设备间共享的磁盘阵列上，设备通过高速网络连接。这种架构可以用来处理某些数据仓库的负载，但是连接以及锁定的消耗限制了共享磁盘方式的扩展性。
