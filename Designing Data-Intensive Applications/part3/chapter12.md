# 第十二章 数据系统的未来

一個以他物為目的者，其最後目的不可能在於保存其自身之存在。為此，舵手不是以保存船為其最後目的，因為船有別的目的，即是為了航行。

（常被引作：如果一个船长的最高目标是保护他的船只，那么他就会让他的船永远停在港口。）

托马斯·阿奎那，*神学大全*（1265-1274）

---

到目前为止，这本书主要是描述事物的*现状*。在这最后一章中，我们将把视角转向未来，讨论事情*应该*是什么样子的：我会提出一些想法和方法，我相信，它们可能会从根本上改进我们设计和构建应用程序的方式。

对未来的看法和猜测当然是主观的，所以我将用本章的第一人称来写我的个人观点。欢迎你反对这些意见并形成你自己的，但我希望这一章中的想法至少能成为富有成效的讨论的起点，并且使经常被混淆的概念更加清晰。

我们在第1章概述了这本书的目标：探讨如何创建*可靠的*、*可扩展的*以及*可维护的*应用与系统。这些主题贯穿了所有章节：例如，我们讨论了许多提升可靠性的容错算法，分区提高可扩展性，以及用于提高可维护性的演进抽象机制。在这一章中，我们将把所有这些想法结合起来，并基于它们展望未来。我们的目标是发现如何设计比今天更好的应用程序——健壮、正确、可演化、最终对人类有益。

## 数据集成

本书中反复出现的一个主题是对于任何给定的问题，都有几种解决方案，它们都有不同的利弊以及取舍。举个例子，在第三章讨论存储引擎时，我们看到了日志结构存储、B树以及面向列的存储。在第五章中讨论复制时，我们看到了单主机、多主机，以及无主机的方法.

如果你有一个比如“我想存储一些数据，之后可以再查找它”的问题，是没有一个正确的解决方案，不同的方法适用于不同的情况。软件实现通常需要选择一种特定的方法。让一个代码路径既坚固又性能良好太难了——在一个软件中尝试做所有的事情几乎可以确保实现会很差。

因此，软件工具的最合适的选择也取决于环境。每款软件，甚至是一个所谓的“通用”数据库，都是为特定的使用模式而设计的。

面对如此众多的备选方案，第一个挑战是找出软件产品与适用环境之间的映射关系。可以理解的是，供应商不愿意告诉你他们的软件不适合的工作负载类型，但是希望前几章已经为你提供了一些问题，以便对其检视，并更好地理解两者之间的取舍。

然而，即使您完全理解了工具和适用它们的环境之间的映射，还有另一个挑战：在复杂的应用中，数据通常以几种不同的方式使用。不太可能有一个软件适合数据使用的*所有*情况，因此你最终不可避免地要拼凑几个不同的软件来提供应用程序的功能。

### 通过衍生数据组合专用的工具

例如，为了处理对任意关键字的查询，常常需要把OLTP数据库与全文搜索索引集成起来。虽然有些数据（比如PostgreSQL）包含对于简单应用足够了的全文索引功能，但是更复杂的搜索工具需要专门的信息检索工具。相反地，搜索索引通常不太适合作为持久的记录系统，因此许多应用程序需要组合两个不同的工具来满足所有的需求。

我们讨论了在“保持系统同步”一节中涉及了集成数据系统的问题。随着数据不同表示方式数量的增加，集成问题变得更加困难。除了数据库和搜索索引之外，您可能还需要在分析系统（数据仓库、批处理以及流处理系统）中保存数据的副本；维护缓存或是从原始数据派生的非规范化版本；通过机器学习、分类、排名或推荐系统传递数据；或者根据对数据的更改发送通知。

令人惊讶的是，我经常看到软件工程师说这样的话：“根据我的经验，99%的人只需要X”或是“…不需要X”（对于X的各种值）。我认为这样的话更多地反映了发言者的经验，而不是一项技术的实际用途。你想要用数据做的不同的事情的范围是非常广的。一个人认为是模糊的、毫无意义的特性很可能是另一个人的中心要求。数据集成的需求通常只有在放大并且考虑整个组织的数据流时才会变得明显。

